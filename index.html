<html ng-app="SpringRollDemo">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
        <link rel="stylesheet/less" type="text/css" href="./styles/styles.less" />
        
        <script src="./lib/jquery-2.1.1.js" type="text/javascript"></script>
        <script src="./lib/less-1.7.0.min.js" type="text/javascript"></script>
        <script src="./lib/angular-1.3.0-beta.7.js" type="text/javascript" ></script>
        <script src="./lib/angular-animate-1.3.0-beta.7.js" type="text/javascript"></script>
        <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.0.3/angular-sanitize.js"></script>

        <script src="./js/special.js"></script>
        <script src="./js/global.js"></script>
        <script src="./js/model.js"></script>
        <script src="./js/checkout.js"></script>
        <script src="./js/compose.js"></script>
        <script src="./js/misc.js"></script>
    </head>
    <body ng-controller="ListingsCtrl" ng-click="dismissNBox();" ng-class="{'no-scroll' : apiPopupEnabled}">
        <div class="DEBUG_baseline_grid enabled-{{ showGridLines }}" ></div>
        <div id="header">
            <div id="header_contents">
                <div id="logo">
                    <h1><img src="images/logo.png" /></h1>
                </div>
                
                <div id="top-navigation">
                    <a ng-repeat="nav in topNavs" ng-class="{active : isTopNavSelected(nav)}" class="{{ nav.type }}" ng-click="switchColumn(nav.type);setTopNavMaster(nav);enableApiPopup('longdan'===nav.type && !apiPopupViewed);">
                        <div class="triangle-up" ng-class="{active : isTopNavSelected(nav)}"></div>
                        <span ng-if="nav.type == 'longdan'">
<!--                            <span class="ld-help" >?</span>-->
                            <img class="ld-help" src="images/api-popup/bubble.png" title="What is this Longdan tab again?" ng-if="apiPopupViewed" ng-click="setViewedApiPopUp(false);"/>
                            <img src="images/longdan.png"/>
                        </span>
                        {{ nav.type != 'longdan' && nav.name || "" }}
                    </a>
                </div>
                
                <a id="user_profile_nav" href="">
                    <img src="images/avatar01.jpg" class="avatar" ng-click="toggleNBox()"/>
                    <span class="badge" ng-click="toggleNBox()">5</span>
                        <!--<div class="triangle"></div>-->
                    <div ng-class="{active : nboxSelected}" class="triangle-up"></div>
                    <div id="notification-box" ng-class="{active : nboxSelected}">
                        <div class="notification" ng-repeat="notification in notifications" ng-click="toggleNBox()">
                            <img ng-src="images/{{ notification.avatar }}" class="avatar"/>
                            <div class="content" ng-bind-html="notification.content"></div>
                            <div class="time">{{ notification.ago }}</div>
                        </div>
                    </div>
                </a>

                <div class="clear"></div>
            </div>
        </div>
        <div ng-include src="'ld-content.html'">
        </div>
        <div id="content" ng-class="selected.type" ng-if="selected.type != 'longdan'">
            <div class="column" ng-repeat="column in columns">
                <div class="post repeated-item" ng-repeat="post in column">
                    <div ng-controller="ComposeCtrl" ng-if="post.type === 'compose'">
                        <div  class="compose" ng-click="setComposeBoxEnabled(true);">
                            <b>+ Post new ad</b>
                        </div>
                        <div class="composeBox" ng-class="{active : composeBoxEnabled}">
                            <h3>New advertisement</h3>
                            <div>
                                <div class="picker">
                                    <div ng-repeat="category in composeCategories"
                                         ng-class="{ 'picked' : pickedCategory === category }"
                                         ng-click="setPickedCategory(category);">{{ category }}</div>
                                </div>
                            </div>
                            <form id="post-form" ng-submit="submitPost()">
                                <input type="text" ng-model="submittedPrice" placeholder='Price, e.g. "£100", "£7/h+tips"'></input>
                                <div class="expiration">Ad expires on 01/01/2015.</div>
                                <textarea ng-model="submittedDesc" placeholder="Short description of your advertisement..."></textarea>
                            </form>
                            <div class="buttons">
                                <div class="submit" onclick="$('#post-form').submit();">Submit</div>
                                <div class="discard" ng-click="setComposeBoxEnabled(false);">Discard</div>
                            </div>
                        </div>
                        <div class="theatre-background" ng-class="{active : composeBoxEnabled}"></div>
                    </div>
                    <div ng-if="post.type != 'longdan' && post.type != 'compose'">
                        <span class="price">{{ post.price }}</span>
                        <span class="time">{{ post.ago }}</span>
                        <div class="description" ng-bind-html="post.description"></div>
                    </div>
                </div>
            </div>
            <div style="clear:both;"></div>
        </div>
        <div id="ld-more" ng-if="selected.type == 'longdan'">More Products >></div>

        <div id="debug_panel">
            <input type=checkbox id="show_grid_lines" ng-model="showGridLines" /><label for="show_grid_lines">Show grid lines</label>
        </div>
    </body>
</html>

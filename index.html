<html ng-app="SpringRollDemo">
    <head>
        <link rel="stylesheet/less" type="text/css" href="./styles/styles.less" />
        
        <script src="./lib/less-1.7.0.min.js" type="text/javascript"></script>
        <script type="text/javascript" src="./lib/angular-1.3.0-beta.7.js"></script>
        <script type="text/javascript" src="./lib/angular-animate-1.3.0-beta.7.js"></script>
        <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.0.3/angular-sanitize.js"></script>
        
        <script src="./js/model.js"></script>
    </head>
    <body id="body" ng-controller="ListingsCtrl" ng-click="dismissNBox();dismissCheckout()" ng-class="{'no-scroll' : checkoutSelected}">
        <div class="DEBUG_baseline_grid enabled-{{ showGridLines }}" ></div>
        <div id="header">
            <div id="header_contents">
                <div id="logo">
                    <h1><img src="images/logo.png" /></h1>
                </div>
                
                <div id="top-navigation">
                    <a ng-repeat="nav in topNavs" ng-class="{active : isTopNavSelected(nav)}" class="{{ nav.type }}" ng-click="emptyColumns();populateByType(nav.type, 350);setTopNavMaster(nav)">
                        <div class="triangle-up" ng-class="{active : isTopNavSelected(nav)}"></div>
                        <span ng-if="nav.type == 'longdan'">
                            <img src="images/longdan.png"/>
                        </span>
                        {{ nav.type != 'longdan' && nav.name || "" }}
                    </a>
                </div>
                
                <a id="user_profile_nav" href="">
                    <img src="images/avatar01.jpg" class="avatar" ng-click="toggleNBox()"/>
                    <span class="badge" ng-click="toggleNBox()">5</span>
                        <!--<div class="triangle"></div>-->
                    <div ng-class="{active : nboxSelected}" class="triangle-up"></div>
                    <div id="notification-box" ng-class="{active : nboxSelected}">
                        <div class="notification" ng-repeat="notification in notifications" ng-click="toggleNBox()">
                            <img ng-src="images/{{ notification.avatar }}" class="avatar"/>
                            <div class="content" ng-bind-html="notification.content"></div>
                            <div class="time">{{ notification.ago }}</div>
                        </div>
                    </div>
                </a>
                
                <div class="clear"></div>
            </div>
        </div>
        <div ng-controller="CheckoutCtrl">
        <div id="ld-header" ng-if="selected.type == 'longdan'">
            <div class="basket">
                <div ng-repeat="category in ldCategories" class="category"><a>{{ category.name }}</a></div>
            </div>
            <div id="basket-price" class="basket" ng-click="prepareCheckout();toggleCheckout();">
                <img id="checkout-basket" src="images/basket.png"/>
                <div class="badge">£{{ basketTotal().toFixed(2) }}</div>
            </div>
            <div id="delivery-price" class="basket" ng-click="prepareCheckout();toggleCheckout();">
                <img id="checkout-truck" ng-src="images/{{ showTruck() }}"/>
<!--                <div class="price" >{{ deliveryFeeDisplay() }}</div>-->
                <div class="badge price" ng-class="{ active : !isDeliveryFree() }">{{ deliveryFeeDisplay() }}</div>
            </div>
            <div class="checkout-overlay" ng-class="{active : checkoutSelected}" ng-click="forceCheckoutOn();">
                <a class="checkout-close" title="Close" ng-click="forceCheckoutOff();">X</a>
                <h2 ng-if="basketTotal() == 0">Your basket is empty!</h2>
                <h2 ng-if="basketTotal() > 0 && isDeliveryFree()">Your Basket: £{{ basketTotal().toFixed(2) }} with FREE DELIVERY</h2>
                <h2 ng-if="basketTotal() > 0 && !isDeliveryFree()">Your Basket: £{{ basketTotal().toFixed(2) }} + {{ deliveryFeeDisplay() }} (delivery) = £{{ (basketTotal() + deliveryFee).toFixed(2) }}</h2>
                <div class="checkout-items" ng-class="{active : basketTotal() > 0}">
                    <div class="checkout-item" ng-repeat="item in checkedOutItems">
                        <img ng-src="{{ item.imageUrl }}"/>
                        <div class="badge right">x{{ item.quantity }} = £{{ item.price.toFixed(2) }}</div>
                    </div>
                    <div style='clear: both'></div>
                </div>
                <a class="checkout-button" ng-class="{active : basketTotal() > 50}">Checkout</a>
                <h4 ng-if="basketTotal() < 50 && basketTotal() > 0">Minimum order to check out: £50</h4>
                <div class="checkout-progress" ng-class="{active : basketTotal() > 0 && basketTotal() < 50}">
                    <span>{{ checkoutProgress() }}</span>
                    <div ng-style="{'width':checkoutProgress()}"></div>
                </div>
            </div>
            <div class="checkout-background" ng-class="{active : checkoutSelected}"></div>
        </div>
        <div id="mkt-header" ng-if="selected.type == 'longdan'">
            <div class="mkt-header-img"></div>
            <div class="mkt-line">
                <span id="authentic"><b>Authentic Vietnamese products by Longdan&reg;</b></span>
                <span id="discount"><b>Exclusive discounts on SVUK Marketplace</b></span>
                <span id="delivery"><b>Free delivery on orders over £100</b></span>
            </div>
        </div>
        <div id="content" ng-class="selected.type">
            <div class="column" ng-repeat="column in columns">
                <div class="post repeated-item" ng-repeat="post in column">
                    <div ng-if="post.type != 'longdan'">
                        <span class="price">{{ post.price }}</span>
                        <span class="time">{{ post.ago }}</span>
                        <div class="description" ng-bind-html="post.description"></div>
                    </div>
                    <div ng-if="post.type == 'longdan'" class="longdan-post">
                        <img ng-src="{{ post.image_url }}" class="image"/>
                        <div class="price-info">
                            <span class="rrp">{{ post.rrp }}</span>
                            <span class="price"><b>{{ post.price }}</b></span>
                        </div>
                        <div class="description" ng-bind-html="post.desc1"></div>
                        <div class="description" ng-bind-html="post.desc2"></div>
                        <div class="packaging" ng-bind-html="post.packaging"></div>
                        <div class="cart">
                            <div class="cart-buttons">
                                <a class="cart-button add" ng-click="addBasket(post.id)">
                                    {{ showQuantity(post.id) }} | + Add
                                </a>
                                <a class="cart-button remove" ng-click="removeBasket(post.id)">
                                    - Remove
                                </a>
                            </div>
                            <div class="divider"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div style="clear:both;"></div>
        </div>
        <div id="ld-more" ng-if="selected.type == 'longdan'">More Products >></div>
        </div>
        <div id="debug_panel">
            <input type=checkbox id="show_grid_lines" ng-model="showGridLines" /><label for="show_grid_lines">Show grid lines</label>
        </div>
        <script src="./js/misc.js"></script>
    </body>
</html>